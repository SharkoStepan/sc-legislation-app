<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Регистрация - Юридический ассистент</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/registration.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <a href="{{ url_for('main.auth') }}">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Логотип" class="header-logo">
            </a>
            <nav>
                <a href="{{ url_for('main.auth') }}"><button class="nav-button">Вход</button></a>
            </nav>
        </header>

        <main>
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Логотип" class="main-logo">
            
            <div class="form-container">
                <h2>Регистрация</h2>
                
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }}">
                                {{ message }}
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <form method="POST" action="{{ url_for('main.reg') }}">
                    {{ form.csrf_token }}
                    
                    <div class="form-group">
                        {{ form.email.label }}
                        {{ form.email(class="form-control", placeholder="example@mail.com") }}
                        {% if form.email.errors %}
                            <span class="error">{{ form.email.errors[0] }}</span>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        {{ form.password.label }}
                        {{ form.password(class="form-control", placeholder="Введите пароль") }}
                        {% if form.password.errors %}
                            <span class="error">{{ form.password.errors[0] }}</span>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        {{ form.password_conf.label }}
                        {{ form.password_conf(class="form-control", placeholder="Повторите пароль") }}
                        {% if form.password_conf.errors %}
                            <span class="error">{{ form.password_conf.errors[0] }}</span>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <label>Тип аккаунта:</label>
                        <div class="radio-group">
                            {% for subfield in form.user_type %}
                            <label class="radio-option">
                                {{ subfield }}
                                <span>{{ subfield.label.text }}</span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Дополнительные поля для специалиста (скрыты по умолчанию) -->
                    <div id="specialist-fields" style="display: none;">
                        <div class="form-group">
                            {{ form.full_name.label }}
                            {{ form.full_name(class="form-control", placeholder="Иванов Иван Иванович") }}
                        </div>

                        <div class="form-group">
                            {{ form.gender.label }}
                            {{ form.gender(class="form-control") }}
                        </div>

                        <div class="form-group">
                            {{ form.age.label }}
                            {{ form.age(class="form-control", placeholder="25") }}
                        </div>

                        <div class="form-group">
                            {{ form.experience.label }}
                            {{ form.experience(class="form-control", placeholder="3") }}
                        </div>

                        <div class="form-group">
                            {{ form.field.label }}
                            {{ form.field(class="form-control") }}
                        </div>
                    </div>

                    {{ form.submit(class="btn-submit") }}
                    
                    <p class="form-footer">
                        Уже есть аккаунт? <a href="{{ url_for('main.auth') }}">Войти</a>
                    </p>
                </form>
            </div>
        </main>

        <footer>
            <p>Персональный ассистент по юриспруденции</p>
            <p>Ostis 2025</p>
        </footer>
    </div>

    <script>
        // Показ/скрытие дополнительных полей для специалиста
        document.addEventListener('DOMContentLoaded', function() {
            const userTypeRadios = document.querySelectorAll('input[name="user_type"]');
            const specialistFields = document.getElementById('specialist-fields');

            function toggleSpecialistFields() {
                const selectedType = document.querySelector('input[name="user_type"]:checked');
                if (selectedType && selectedType.value === 'specialist') {
                    specialistFields.style.display = 'block';
                } else {
                    specialistFields.style.display = 'none';
                }
            }

            userTypeRadios.forEach(radio => {
                radio.addEventListener('change', toggleSpecialistFields);
            });

            // Проверка при загрузке страницы
            toggleSpecialistFields();
        });
    </script>
</body>
</html>
